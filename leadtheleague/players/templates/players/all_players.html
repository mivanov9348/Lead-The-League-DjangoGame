{% extends 'base.html' %}
{% block title %}All Players{% endblock %}

{% block extra_css %}
{% load static %}
{% load humanize %}

<link rel="stylesheet" href="{% static 'css/all_players.css' %}">
<link rel="stylesheet" href="{% static 'css/players_filter.css' %}">
{% endblock %}

{% block content %}

<div class="transfer-market">
    <h1>All Players</h1>

    <!-- Filter Section -->
    <form method="get" class="filter-container">
    <div class="filter-row">
        <select name="team" id="team">
            <option value="">All Teams</option>
            {% for team in teams %}
            <option value="{{ team }}">{{ team }}</option>
            {% endfor %}
        </select>
        <select name="nationality" id="nationality">
            <option value="">All Nationalities</option>
            {% for nationality in nationalities %}
            <option value="{{ nationality.abbreviation }}">{{ nationality.name }}</option>
            {% endfor %}
        </select>
        <select name="position" id="position">
            <option value="">All Positions</option>
            {% for position in positions %}
            <option value="{{ position.abbreviation }}">{{ position.name }}</option>
            {% endfor %}
        </select>
        <input type="number" name="age_min" placeholder="Min Age">
        <input type="number" name="age_max" placeholder="Max Age">
        <button type="submit">Apply</button>
    </div>
    <div class="filter-row">
        <select name="sort_by" id="sort_by">
            <option value="">Sort By</option>
            <option value="assists">Assists</option>
            <option value="cleanSheets">Clean Sheets</option>
            <option value="conceded">Conceded</option>
            <option value="dribbles">Dribbles</option>
            <option value="fouls">Fouls</option>
            <option value="goals">Goals</option>
            <option value="matches">Matches</option>
            <option value="minutesPlayed">Minutes Played</option>
            <option value="passes">Passes</option>
            <option value="redCards">Red Cards</option>
            <option value="saves">Saves</option>
            <option value="shoots">Shoots</option>
            <option value="shootsOnTarget">Shoots On Target</option>
            <option value="tackles">Tackles</option>
            <option value="yellowCards">Yellow Cards</option>
            <option value="price">Price</option>
        </select>
        <button type="submit">Filter</button>
        <a href="{% url 'players:all_players' %}" class="reset-btn">Reset</a> <!-- Фиксирано -->
    </div>
</form>


    <!-- Players Table -->
    <div class="table-container">

        <table>
            <thead>
            <tr>
                <th title="Number"><i class="fas fa-hashtag"></i></th>
                <th title="Name"><i class="fas fa-user"></i></th>
                <th title="Team"><i class="fas fa-users"></i></th>
                <th title="Position"><i class="fas fa-compass"></i></th>
                <th title="Nationality"><i class="fas fa-flag"></i></th>
                <th title="Age"><i class="fas fa-birthday-cake"></i></th>
                <th title="Goals"><i class="fas fa-futbol"></i></th>
                <th title="Assists"><i class="fas fa-handshake"></i></th>
                <th title="Matches Played"><i class="fas fa-calendar-check"></i></th>
                <th title="Minutes Played"><i class="fas fa-clock"></i></th>
                <th title="Passes"><i class="fas fa-arrows-alt"></i></th>
                <th title="Dribbles"><i class="fas fa-running"></i></th>
                <th title="Shoots"><i class="fas fa-bullseye"></i></th>
                <th title="Tackles"><i class="fas fa-shield-alt"></i></th>
                <th title="Clean Sheets"><i class="fas fa-broom"></i></th>
                <th title="Conceded"><i class="fas fa-frown"></i></th>
                <th title="Saves"><i class="fas fa-hands"></i></th>
                <th title="Fouls"><i class="fas fa-exclamation-circle"></i></th>
                <th title="Yellow Cards"><i class="fas fa-square"></i></th>
                <th title="Red Cards"><i class="fas fa-square-full"></i></th>
                <th title="Rating"><i class="fas fa-star"></i></th>
                <th title="Price">
                    <a href="?sort_by=price">
                        <i class="fas fa-dollar-sign"></i>
                        Price
                    </a>
                </th>
            </tr>
            </thead>
            <tbody>
            {% for player in player_data %}
            <tr>
                <td><img class="icon" src="{{ player.personal_info.image }}" alt="Player Image"></td>
                <td>
                    <a href="{% url 'players:player_profile' player.personal_info.id %}">
                        {{ player.personal_info.name }}
                    </a>
                </td>
                <td>{{ player.team_info.team_name }}</td>
                <td>{{ player.personal_info.positionabbr }}</td>
                <td>{{ player.personal_info.nationalityabbr }}</td>
                <td>{{ player.personal_info.age }}</td>
                <td>{{ player.season_stats.goals }}</td>
                <td>{{ player.season_stats.assists }}</td>
                <td>{{ player.season_stats.matches }}</td>
                <td>{{ player.season_stats.minutesPlayed }}</td>
                <td>{{ player.season_stats.passes }}</td>
                <td>{{ player.season_stats.dribbles }}</td>
                <td>{{ player.season_stats.shoots }} ({{ player.season_stats.shootsOnTarget }})</td>
                <td>{{ player.season_stats.tackles }}</td>
                <td>{{ player.season_stats.cleanSheets }}</td>
                <td>{{ player.season_stats.conceded }}</td>
                <td>{{ player.season_stats.saves }}</td>
                <td>{{ player.season_stats.fouls }}</td>
                <td>{{ player.season_stats.yellowCards }}</td>
                <td>{{ player.season_stats.redCards }}</td>
                <td>{{ player.personal_info.rating }}</td>
                <td>{{ player.personal_info.price|intcomma }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="pagination">
        {% if pages %}
        {% for page in pages %}
        {% if page == current_page %}
        <span>{{ page }}</span>
        {% else %}
        <a href="?page={{ page }}">{{ page }}</a>
        {% endif %}
        {% endfor %}
        {% endif %}
    </div>
</div>
{% endblock %}
